from aiogram import F, Router  # F - –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤, Router - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞
from aiogram.types import CallbackQuery, Message  # –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π
from aiogram.fsm.context import (
    FSMContext,
)  # –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å FSM (Finite State Machine)
from aiogram.fsm.state import State, StatesGroup  # –ö–ª–∞—Å—Å—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
import sqlite3  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å SQLite –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

# –°–æ–∑–¥–∞–µ–º —Ä–æ—É—Ç–µ—Ä - –æ–±—ä–µ–∫—Ç –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
router = Router()


# –°–û–ó–î–ê–ï–ú –ö–õ–ê–°–° –°–û–°–¢–û–Ø–ù–ò–ô (STATESGROUP)
# StatesGroup - —ç—Ç–æ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
# –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç StatesGroup –ø–æ–∑–≤–æ–ª—è–µ—Ç aiogram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è
class AddMonthlyReminder(StatesGroup):
    """
    –ö–ª–∞—Å—Å —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.
    –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –¥–∏–∞–ª–æ–≥–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
    """

    # State() —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
    date = State()  # –°–æ—Å—Ç–æ—è–Ω–∏–µ 1: –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ —á–∏—Å–ª–∞ (–¥–∞—Ç—ã)
    event = State()  # –°–æ—Å—Ç–æ—è–Ω–∏–µ 2: –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ —Å–æ–±—ã—Ç–∏—è (—Ç–µ–∫—Å—Ç–∞)


class DeleteMonthlyReminder(StatesGroup):
    """
    –ö–ª–∞—Å—Å —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.
    –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –¥–∏–∞–ª–æ–≥–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
    """

    select_id = State()  # –°–æ—Å—Ç–æ—è–Ω–∏–µ 1: –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ ID –∑–∞–ø–∏—Å–∏ –∏ —É–¥–∞–ª–µ–Ω–∏–µ


class AddAnnualReminder(StatesGroup):
    """
    –ö–ª–∞—Å—Å —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.
    –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –¥–∏–∞–ª–æ–≥–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
    """

    # State() —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
    date = State()  # –°–æ—Å—Ç–æ—è–Ω–∏–µ 1: –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ —á–∏—Å–ª–∞ (–¥–∞—Ç—ã)
    event = State()  # –°–æ—Å—Ç–æ—è–Ω–∏–µ 2: –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ —Å–æ–±—ã—Ç–∏—è (—Ç–µ–∫—Å—Ç–∞)


class DeleteAnnualReminder(StatesGroup):
    """
    –ö–ª–∞—Å—Å —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.
    –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –¥–∏–∞–ª–æ–≥–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
    """

    select_id = State()  # –°–æ—Å—Ç–æ—è–Ω–∏–µ 1: –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ ID –∑–∞–ø–∏—Å–∏ –∏ —É–¥–∞–ª–µ–Ω–∏–µ


# –û–ë–†–ê–ë–û–¢–ß–ò–ö –ù–ê–ñ–ê–¢–ò–Ø –ù–ê –ö–ù–û–ü–ö–£ "–î–æ–±–∞–≤–∏—Ç—å" (–ù–ê–ß–ê–õ–û –ü–†–û–¶–ï–°–°–ê)
@router.callback_query(F.data == "monthly_reminders_write")
async def add_monthly_reminder_start(callback: CallbackQuery, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ inline-–∫–Ω–æ–ø–∫—É
    —Å callback_data="monthly_reminders_write"

    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - callback: CallbackQuery - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏
    - state: FSMContext - –æ–±—ä–µ–∫—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –≤–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ
    await callback.message.answer("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ:")

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # set_state() –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    # –¢–µ–ø–µ—Ä—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
    await state.set_state(AddMonthlyReminder.date)


# –û–ë–†–ê–ë–û–¢–ß–ò–ö –í–í–û–î–ê –î–ê–¢–´ (–ü–ï–†–í–´–ô –®–ê–ì)
@router.message(AddMonthlyReminder.date)
async def save_date_monthly_reminders(message: Message, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞:
    1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    2. –¢–ï–ö–£–©–ï–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = AddMonthlyReminder.date

    –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —á–∏—Å–ª–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –µ–≥–æ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
    """
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–≤–µ–¥–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ FSM
    # update_data() –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
    # –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–∞—Ö
    await state.update_data(date=message.text)

    # –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ
    # –¢–µ–ø–µ—Ä—å –±—É–¥–µ–º –∂–¥–∞—Ç—å –≤–≤–æ–¥ —Å–æ–±—ã—Ç–∏—è
    await state.set_state(AddMonthlyReminder.event)

    # –ü—Ä–æ—Å–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–µ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–µ
    await message.answer("–í–≤–µ–¥–∏—Ç–µ –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:")


# –û–ë–†–ê–ë–û–¢–ß–ò–ö –í–í–û–î–ê –°–û–ë–´–¢–ò–Ø (–í–¢–û–†–û–ô –®–ê–ì –ò –°–û–•–†–ê–ù–ï–ù–ò–ï –í –ë–î)
@router.message(AddMonthlyReminder.event)
async def save_event_monthly_reminders(message: Message, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞:
    1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    2. –¢–ï–ö–£–©–ï–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = ddMonthlyReminder.event

    –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    """

    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ FSM
    # get_data() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ —á–µ—Ä–µ–∑ update_data()
    data = await state.get_data()

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞—Ç—É –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    # data['date'] - —ç—Ç–æ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ
    date = data["date"]

    # message.text - —ç—Ç–æ —Ç–µ–∫—Å—Ç —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª —Å–µ–π—á–∞—Å
    event = message.text

    # –°–û–•–†–ê–ù–ï–ù–ò–ï –í –ë–ê–ó–£ –î–ê–ù–ù–´–• SQLite
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (with) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
    # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
    # 1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î
    # 2. –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –±–ª–æ–∫–∞ - –¥–µ–ª–∞–µ—Ç commit (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    # 3. –ü—Ä–∏ –æ—à–∏–±–∫–µ - –¥–µ–ª–∞–µ—Ç rollback (–æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    # 4. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î
    with sqlite3.connect("db/calendar.db") as conn:

        # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        # IF NOT EXISTS –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ–µ –µ—â–µ –Ω–µ—Ç
        conn.execute(
            "CREATE TABLE IF NOT EXISTS monthly_reminders (date TEXT, event TEXT)"
        )

        # –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É
        # ? - placeholders –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
        # (date, event) - –∫–æ—Ä—Ç–µ–∂ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Å—Ç–∞–≤—è—Ç—Å—è –≤–º–µ—Å—Ç–æ ?
        conn.execute(
            "INSERT INTO monthly_reminders (id, date, event) VALUES (NULL, ?, ?)",
            (date, event),
        )
        # commit() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –±–ª–æ–∫–∞ with

    # –ó–ê–í–ï–†–®–ï–ù–ò–ï –ü–†–û–¶–ï–°–°–ê
    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # clear() —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ FSM –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ" —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    await state.clear()
    await message.answer(f"–°–æ–±—ã—Ç–∏–µ {date} {event} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ë–î")


@router.callback_query(F.data == "monthly_reminders_delete")
async def delete_reminder_start(callback: CallbackQuery, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ inline-–∫–Ω–æ–ø–∫—É
    —Å callback_data="monthly_reminders_delete"
    """

    # –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∂–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
    with sqlite3.connect("db/calendar.db") as conn:
        cursor = conn.cursor()

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞
        cursor.execute(
            "SELECT name FROM sqlite_master WHERE type='table' AND name='monthly_reminders'"
        )
        if not cursor.fetchone():
            await callback.message.answer("üì≠ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞. –ù–µ—á–µ–≥–æ —É–¥–∞–ª—è—Ç—å.")
            return

        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
        cursor.execute("SELECT id, date, event FROM monthly_reminders ORDER BY id")
        records = cursor.fetchall()

        if not records:
            await callback.message.answer("üì≠ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞. –ù–µ—á–µ–≥–æ —É–¥–∞–ª—è—Ç—å.")
            return

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–ø–∏—Å–µ–π
        message_text = "üìã –°–ø–∏—Å–æ–∫ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π:\n\n"
        for record in records:
            id_num, date, event = record
            message_text += (
                f"<b>ID - {str(id_num).ljust(4)}</b> {event} - {str(date)} —á–∏—Å–ª–æ\n"
            )

        message_text += "\n–í–≤–µ–¥–∏—Ç–µ ID –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å:"

    await callback.message.answer(message_text, parse_mode="HTML")

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    await state.set_state(DeleteMonthlyReminder.select_id)


@router.message(DeleteMonthlyReminder.select_id)
async def select_id_for_delete(message: Message, state: FSMContext):
    """
    –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: —É–¥–∞–ª—è–µ–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ ID
    """
    try:
        record_id = int(message.text.strip())

        with sqlite3.connect("db/calendar.db") as conn:
            cursor = conn.cursor()

            # –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø–∏—Å–∏ –¥–ª—è –æ—Ç—á–µ—Ç–∞
            cursor.execute(
                "SELECT date, event FROM monthly_reminders WHERE id = ?", (record_id,)
            )
            record = cursor.fetchone()

            if not record:
                await message.answer(f"‚ùå –ó–∞–ø–∏—Å—å —Å ID {record_id} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
                await state.clear()
                return

            date, event = record

            # –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å
            cursor.execute("DELETE FROM monthly_reminders WHERE id = ?", (record_id,))

            await message.answer(
                f"‚úÖ –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞:\n"
                f"ID: {record_id}\n"
                f"–ß–∏—Å–ª–æ: {date}\n"
                f"–°–æ–±—ã—Ç–∏–µ: {event}"
            )

    except ValueError:
        await message.answer(
            "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä ID (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ):"
        )
        return
    except sqlite3.Error as e:
        await message.answer(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: {e}")

    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    await state.clear()


@router.callback_query(F.data == "annual_reminders_write")
async def add_monthly_reminder_start(callback: CallbackQuery, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ inline-–∫–Ω–æ–ø–∫—É
    —Å callback_data="annual_reminders_write"

    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - callback: CallbackQuery - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏
    - state: FSMContext - –æ–±—ä–µ–∫—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –≤–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ
    await callback.message.answer("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –∏ –º–µ—Å—è—Ü –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥.–º. :")

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # set_state() –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    # –¢–µ–ø–µ—Ä—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
    await state.set_state(AddAnnualReminder.date)


# –û–ë–†–ê–ë–û–¢–ß–ò–ö –í–í–û–î–ê –î–ê–¢–´ (–ü–ï–†–í–´–ô –®–ê–ì)
@router.message(AddAnnualReminder.date)
async def save_date_monthly_reminders(message: Message, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞:
    1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    2. –¢–ï–ö–£–©–ï–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = AddAnnualReminder.date

    –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —á–∏—Å–ª–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –µ–≥–æ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
    """
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–≤–µ–¥–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ FSM
    # update_data() –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
    # –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–∞—Ö
    await state.update_data(date=message.text)

    # –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ
    # –¢–µ–ø–µ—Ä—å –±—É–¥–µ–º –∂–¥–∞—Ç—å –≤–≤–æ–¥ —Å–æ–±—ã—Ç–∏—è
    await state.set_state(AddAnnualReminder.event)

    # –ü—Ä–æ—Å–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–µ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–µ
    await message.answer("–í–≤–µ–¥–∏—Ç–µ –µ–∂–µ–≥–æ–¥–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:")


# –û–ë–†–ê–ë–û–¢–ß–ò–ö –í–í–û–î–ê –°–û–ë–´–¢–ò–Ø (–í–¢–û–†–û–ô –®–ê–ì –ò –°–û–•–†–ê–ù–ï–ù–ò–ï –í –ë–î)
@router.message(AddAnnualReminder.event)
async def save_event_monthly_reminders(message: Message, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞:
    1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    2. –¢–ï–ö–£–©–ï–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = AddAnnualReminder.event

    –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    """

    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ FSM
    # get_data() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ —á–µ—Ä–µ–∑ update_data()
    data = await state.get_data()

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞—Ç—É –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    # data['date'] - —ç—Ç–æ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ
    date = data["date"]

    # message.text - —ç—Ç–æ —Ç–µ–∫—Å—Ç —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª —Å–µ–π—á–∞—Å
    event = message.text

    # –°–û–•–†–ê–ù–ï–ù–ò–ï –í –ë–ê–ó–£ –î–ê–ù–ù–´–• SQLite
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (with) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
    # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
    # 1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î
    # 2. –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –±–ª–æ–∫–∞ - –¥–µ–ª–∞–µ—Ç commit (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    # 3. –ü—Ä–∏ –æ—à–∏–±–∫–µ - –¥–µ–ª–∞–µ—Ç rollback (–æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    # 4. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î
    with sqlite3.connect("db/calendar.db") as conn:

        # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        # IF NOT EXISTS –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ–µ –µ—â–µ –Ω–µ—Ç
        conn.execute(
            "CREATE TABLE IF NOT EXISTS annual_reminders (date TEXT, event TEXT)"
        )

        # –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É
        # ? - placeholders –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
        # (date, event) - –∫–æ—Ä—Ç–µ–∂ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Å—Ç–∞–≤—è—Ç—Å—è –≤–º–µ—Å—Ç–æ ?
        conn.execute(
            "INSERT INTO annual_reminders (id, date, event) VALUES (NULL, ?, ?)",
            (date, event),
        )
        # commit() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –±–ª–æ–∫–∞ with

    # –ó–ê–í–ï–†–®–ï–ù–ò–ï –ü–†–û–¶–ï–°–°–ê
    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # clear() —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ FSM –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ "–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ" —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    await state.clear()
    await message.answer(f"–°–æ–±—ã—Ç–∏–µ {date} {event} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ë–î")


@router.callback_query(F.data == "annual_reminders_delete")
async def delete_reminder_start(callback: CallbackQuery, state: FSMContext):
    """
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ inline-–∫–Ω–æ–ø–∫—É
    —Å callback_data="annual_reminders_delete"
    """

    # –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∂–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
    with sqlite3.connect("db/calendar.db") as conn:
        cursor = conn.cursor()

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞
        cursor.execute(
            "SELECT name FROM sqlite_master WHERE type='table' AND name='annual_reminders'"
        )
        if not cursor.fetchone():
            await callback.message.answer("üì≠ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞. –ù–µ—á–µ–≥–æ —É–¥–∞–ª—è—Ç—å.")
            return

        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
        cursor.execute("SELECT id, date, event FROM annual_reminders ORDER BY id")
        records = cursor.fetchall()

        if not records:
            await callback.message.answer("üì≠ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞. –ù–µ—á–µ–≥–æ —É–¥–∞–ª—è—Ç—å.")
            return

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–ø–∏—Å–µ–π
        message_text = "üìã –°–ø–∏—Å–æ–∫ –µ–∂–µ–≥–æ–¥–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π:\n\n"
        for record in records:
            id_num, date, event = record
            message_text += (
                f"<b>ID - {str(id_num).ljust(4)}</b>  {event} - {str(date)}\n"
            )

        message_text += "\n–í–≤–µ–¥–∏—Ç–µ ID –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å:"

    await callback.message.answer(message_text, parse_mode="HTML")

    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    await state.set_state(DeleteAnnualReminder.select_id)


@router.message(DeleteAnnualReminder.select_id)
async def select_id_for_delete(message: Message, state: FSMContext):
    """
    –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: —É–¥–∞–ª—è–µ–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ ID
    """
    try:
        record_id = int(message.text.strip())

        with sqlite3.connect("db/calendar.db") as conn:
            cursor = conn.cursor()

            # –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø–∏—Å–∏ –¥–ª—è –æ—Ç—á–µ—Ç–∞
            cursor.execute(
                "SELECT date, event FROM annual_reminders WHERE id = ?", (record_id,)
            )
            record = cursor.fetchone()

            if not record:
                await message.answer(f"‚ùå –ó–∞–ø–∏—Å—å —Å ID {record_id} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
                await state.clear()
                return

            date, event = record

            # –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å
            cursor.execute("DELETE FROM annual_reminders WHERE id = ?", (record_id,))

            await message.answer(
                f"‚úÖ –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞:\n"
                f"ID: {record_id}\n"
                f"–î–∞—Ç–∞: {date}\n"
                f"–°–æ–±—ã—Ç–∏–µ: {event}"
            )

    except ValueError:
        await message.answer(
            "‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä ID (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ):"
        )
        return
    except sqlite3.Error as e:
        await message.answer(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: {e}")

    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    await state.clear()
